<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>금액별 스쿼드</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.14.0-beta2/css/bootstrap-select.min.css">
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      padding-top: 60px;
      background: #f5f5f5;
    }
    .input-group {
      margin-bottom: 15px;
    }
    input[type="text"] {
      width: 100%;
      padding: 10px;
      font-size: 16px;
      box-sizing: border-box;
      margin-bottom: 20px;
    }
    /* 팀 아이템 컨테이너 (각 팀 별 구분선 추가) */
    .team-item {
      margin-bottom: 20px;
      background: #fff;
      border: 1px solid #ddd;
      border-radius: 4px;
      overflow: hidden;
    }
    /* 팀 버튼 */
    .team-btn {
      width: 100%;
      text-align: left;
      background: #f7f7f7;
      border: none;
      padding: 10px;
      font-size: 16px;
      cursor: pointer;
    }
    .team-btn:hover {
      background: #eaeaea;
    }
    /* 가격 옵션 컨테이너 (초기엔 숨김, 팀 내부에 인덴트 적용) */
    .price-options {
      display: none;
      border-top: 1px solid #ddd;
      background: #fff;
      padding-left: 20px; /* 인덴트 추가 */
    }
    /* 각 가격 버튼에 구분 선 추가 (마지막 버튼 제외) */
    .price-options .price-btn {
      width: 100%;
      text-align: left;
      border: none;
      padding: 10px;
      font-size: 15px;
      cursor: pointer;
      background: #fff;
    }
    .price-options .price-btn:not(:last-child) {
      border-bottom: 1px solid #ddd;
    }
    .price-btn:hover {
      background: #f0f0f0;
    }
    /* 스쿼드 이미지가 들어갈 영역 */
    .squad-display {
      text-align: center;
      margin-top: 10px;
      padding: 10px;
      border-top: 1px solid #ddd;
    }
    .squad-display img {
      max-width: 100%;
      height: auto;
    }
    /* 네비게이션 바 */
    #navbar {
      background: #73685d;
      padding: 0.3rem 1rem;
    }
  </style>
</head>
<body>

  <nav id="navbar" class="navbar navbar-expand-lg navbar-dark fixed-top">
    <div class="container-fluid">
      <!-- 뒤로가기 버튼 -->
      <a class="navbar-brand" href="#" id="toolTabButton"></a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarContent">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarContent">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item"><a class="nav-link" href="https://kritikal619.github.io/card/" target="_blank">피모합성소</a></li>
          <li class="nav-item"><a class="nav-link" href="https://kritikal619.github.io/trait/" target="_blank">피모 특성</a></li>
          <li class="nav-item"><a class="nav-link" href="http://fcevol.kro.kr" target="_blank">진화 시뮬레이션</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- 상단 검색창 -->
  <div class="input-group">
    <input type="text" id="search" placeholder="예: 팀 1 1000 (엔터키로 검색)">
  </div>

  <!-- 팀 목록이 들어갈 영역 -->
  <div id="teamsContainer"></div>

  <script>
    // 데이터 수정: GitHub 레포 내의 이미지 파일 경로를 사용 (상대경로 예시)
    // GitHub Pages를 사용 중이면 URL을 "https://your-username.github.io/your-repo-name/images/파일이름" 형식으로 사용할 수 있습니다.
    const data = {
      team1: {
        name: "레알 마드리드",
        prices: {
          '500': './images/500억레알.png',
          '1000': './images/1000억레알.png',
          '3000': './images/3000억레알.png',
          '8000': './images/8000억레알.png',
          '20000': './images/20000억레알.png'
        }
      },
      team2: {
        name: "팀 2",
        prices: {
          '1500': './images/team2-price1500.png',
          '2500': './images/team2-price2500.png'
        }
      }
    };

    const teamsContainer = document.getElementById('teamsContainer');
    const searchInput = document.getElementById('search');

    // 각 팀의 요소들을 저장하는 객체 (나중에 검색 시 사용)
    const teamElements = {};

    // 데이터에 있는 팀들을 기반으로 팀 버튼 생성
    Object.keys(data).forEach(teamKey => {
      // 팀 아이템 컨테이너 생성
      const teamItem = document.createElement('div');
      teamItem.className = 'team-item';

      // 팀 버튼 생성
      const teamBtn = document.createElement('button');
      teamBtn.className = 'team-btn';
      teamBtn.textContent = data[teamKey].name;
      teamBtn.dataset.team = teamKey;
      teamItem.appendChild(teamBtn);

      // 가격 옵션 컨테이너 생성 (초기엔 숨김, 인덴트 적용됨)
      const priceOptions = document.createElement('div');
      priceOptions.className = 'price-options';
      teamItem.appendChild(priceOptions);

      // 스쿼드 이미지를 표시할 영역 (가격 옵션 아래)
      const squadDisplay = document.createElement('div');
      squadDisplay.className = 'squad-display';
      // 현재 선택된 가격을 저장할 데이터 속성
      squadDisplay.dataset.activePrice = "";
      teamItem.appendChild(squadDisplay);

      // 팀 버튼 클릭 시 가격 옵션 토글 (펼치거나 숨김)
      teamBtn.addEventListener('click', function() {
        // 다른 팀들의 옵션은 닫기
        document.querySelectorAll('.price-options').forEach(div => {
          if (div !== priceOptions) {
            div.style.display = 'none';
            // 해당 팀의 스쿼드 영역 초기화
            const otherSquad = div.parentElement.querySelector('.squad-display');
            otherSquad.innerHTML = '';
            otherSquad.dataset.activePrice = "";
          }
        });
        // 토글: 이미 열려있으면 닫고, 아니면 열기
        if (priceOptions.style.display === 'block') {
          priceOptions.style.display = 'none';
          squadDisplay.innerHTML = ''; // 가격 옵션 닫으면 스쿼드도 초기화
          squadDisplay.dataset.activePrice = "";
        } else {
          // 가격 옵션 영역에 버튼 추가 (한번만 추가되도록)
          if (!priceOptions.hasChildNodes()) {
            Object.keys(data[teamKey].prices).forEach(price => {
              const priceBtn = document.createElement('button');
              priceBtn.className = 'price-btn';
              priceBtn.textContent = price + '억';
              priceBtn.dataset.team = teamKey;
              priceBtn.dataset.price = price;
              // 가격 버튼 클릭 시 해당 스쿼드 이미지 토글
              priceBtn.addEventListener('click', function(e) {
                // 이벤트 전파를 막아 팀 버튼의 토글이 동작하지 않도록 함
                e.stopPropagation();
                const team = this.dataset.team;
                const price = this.dataset.price;
                const imgUrl = data[team].prices[price];
                // 만약 이미 선택된 가격이면 스쿼드 이미지를 제거 (토글)
                if (squadDisplay.dataset.activePrice === price) {
                  squadDisplay.innerHTML = '';
                  squadDisplay.dataset.activePrice = "";
                } else {
                  squadDisplay.innerHTML = '';
                  const img = document.createElement('img');
                  img.src = imgUrl;
                  img.alt = data[team].name + ' 스쿼드';
                  squadDisplay.appendChild(img);
                  squadDisplay.dataset.activePrice = price;
                }
              });
              priceOptions.appendChild(priceBtn);
            });
          }
          priceOptions.style.display = 'block';
        }
      });

      teamsContainer.appendChild(teamItem);
      // 저장: 나중에 검색 시 해당 팀 요소에 접근하기 위해
      teamElements[teamKey] = {
        teamItem,
        teamBtn,
        priceOptions,
        squadDisplay
      };
    });

    // 검색 입력에서 엔터키 입력 시 실행
    searchInput.addEventListener('keypress', function(e) {
      if (e.key === "Enter") {
        processSearch();
      }
    });

    // 검색어 처리 함수
    function processSearch() {
      const query = searchInput.value.trim().toLowerCase();
      if (!query) return;

      // 예시로, 검색어에 팀 이름과 가격(숫자)이 포함되어 있다고 가정합니다.
      // 예: "팀 1 1000" 또는 "팀1 2000"
      let foundTeamKey = null;
      let foundPrice = null;

      // 먼저 팀 이름 매칭 (data의 name 속성을 이용)
      Object.keys(data).forEach(teamKey => {
        const teamName = data[teamKey].name.toLowerCase();
        if (query.indexOf(teamName) > -1) {
          foundTeamKey = teamKey;
        }
      });

      // 검색어에서 숫자(가격)를 찾아봅니다.
      const priceMatch = query.match(/\d+/);
      if (priceMatch) {
        foundPrice = priceMatch[0];
      }

      if (foundTeamKey) {
        // 해당 팀의 버튼을 강제로 클릭하여 가격 옵션을 펼칩니다.
        const { teamItem, teamBtn, priceOptions, squadDisplay } = teamElements[foundTeamKey];
        // 만약 가격 옵션이 닫혀있다면 열기 위한 클릭
        if (priceOptions.style.display !== 'block') {
          teamBtn.click();
        }
        // 스크롤을 부드럽게 해당 팀 영역으로 이동
        teamItem.scrollIntoView({ behavior: 'smooth', block: 'start' });

        // 가격이 검색어에 포함되어 있고, 해당 팀의 가격 옵션에 존재하면 자동 클릭
        if (foundPrice) {
          setTimeout(() => {
            const priceBtns = priceOptions.querySelectorAll('.price-btn');
            priceBtns.forEach(btn => {
              if (btn.dataset.price === foundPrice) {
                btn.click();
              }
            });
          }, 300);
        }
      }
    }
  </script>
</body>
</html>
